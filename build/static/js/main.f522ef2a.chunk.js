(this["webpackJsonpquillbot-frontend"]=this["webpackJsonpquillbot-frontend"]||[]).push([[0],{128:function(e,t,a){e.exports=a.p+"static/media/logo.4e2b85f3.png"},199:function(e,t,a){e.exports=a(422)},204:function(e,t,a){},312:function(e,t){},422:function(e,t,a){"use strict";a.r(t);var n=a(195),r=a(0),o=a.n(r),c=a(5),l=a.n(c),s=a(46),i=a(131),u=(a(204),a(127),a(61)),m=a(22),p=a(23),h=a(24),d=a(25),b=a(128),g=a.n(b),f=(a(53),a(26)),v=(a(139),a(98)),E=v.a.Footer,y=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("main",null,o.a.createElement("div",{className:"main-bar"},this.props.children),o.a.createElement(E,null,"Developed by",o.a.createElement(f.a,{type:"link",href:"",block:!0,target:"_blank"},"Shubham")))}}]),a}(o.a.Component),w={dashboard:"/",login:"/login",auth:"/auth/:provider/callback"},k={BASE_URL:"http://localhost:1337",path:w,color:{},DEV_MODE:!0,SOCKET_PORT:1342},O=(a(116),a(33)),S=a(52),j=a.n(S),I=(a(423),k.BASE_URL),C=localStorage.getItem("token");C&&(j.a.defaults.headers.common.Authorization="Bearer ".concat(C));var D=new Promise((function(e,t){localStorage.getItem("access_token")?(j.a.defaults.headers.common.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e(!0)):j.a.get("".concat(I,"/")).then((function(t){var a=t.data;t.data.success&&(localStorage.setItem("access_token",a.data.token),j.a.defaults.headers.common.Authorization="Bearer ".concat(localStorage.getItem("access_token"))),e(!0)}))})),N=function(e){var t=e.path,a=e.params,n=(e.headers,e.cb),r=e.err;D.then((function(){j.a.get("".concat(I).concat(t),{params:a}).then((function(e){200===e.status&&n?n(e):r&&r(e.error)})).catch((function(e){return k.DEV_MODE||e&&e.response&&404===e.response.status?(r&&r(e.response),void O.a.error("Connection Error!")):e&&e.response&&401===e.response.status?(O.a.warning("Unauthorised request! You will be logged out."),void A((function(){setTimeout((function(){window.location.reload(!0)}),300)}))):void O.a.warning("Something went wrong!!")}))}))},_=function(e){var t=e.path,a=e.params,n=(e.headers,e.cb),r=e.err;D.then((function(){j.a.post("".concat(I).concat(t),a).then((function(e){200!==e.status&&201!==e.status||!n?r(e):n(e.data)})).catch((function(e){return e&&e.response&&401===e.response.status?(O.a.warning("Unauthorised request! You will be logged out."),void A((function(){setTimeout((function(){window.location.reload(!0)}),300)}))):k.DEV_MODE||404===e.response.status?r?void r(e.response):(O.a.warning("Something went wrong!!"),void A((function(){setTimeout((function(){window.location.reload(!0)}),300)}))):void O.a.warning("Something went wrong!!")}))}))},A=function(e){localStorage.removeItem("token"),localStorage.removeItem("user"),e({status:200,message:"Logged Out!"})},L=function(e,t,a){_({path:"/subscribe",params:e,cb:t,err:a})},U=function(e,t,a){_({path:"/unsubscribe",params:e,cb:t,err:a})},x=function(e){"/auth/google/callback"!==window.location.pathname?JSON.parse(localStorage.getItem("user"))&&(e.history.push(w.home),window.history.pushState({},"Home","/")):window.history.pushState({},"Home","/#/auth/google/callback"+window.location.search)},M=(a(273),a(194)),B=(a(275),a(62)),F=(a(277),a(191)),T=(a(424),a(138)),q=(a(281),a(182)),H=(a(283),a(193)),J=(a(285),a(183)),R=a(192),Y=a(134),P=a.n(Y),W=(localStorage.getItem("token"),a(288)),z=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).handleData=function(e){"message"===e.code?n.setState({comments:[].concat(Object(R.a)(n.state.comments),[e.message])}):O.a.error(e.message)},n.state={comments:[]},n.socket=W("http://127.0.0.1:1342",{transports:["websocket"],reconnection:!0,upgrade:!1}),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("user"));this.socket.on("connect",(function(){console.log("Connected!")})),this.socket.emit("join",{sub:e.sub}),this.socket.on("message",this.handleData)}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state.comments;return o.a.createElement(o.a.Fragment,null,e&&e.map((function(e){return o.a.createElement(q.a,{author:o.a.createElement("a",null,e.authorDetails.displayName),avatar:o.a.createElement(J.a,{src:e.authorDetails.profileImageUrl,alt:e.authorDetails.displayName}),content:o.a.createElement("p",null,e.snippet.displayMessage),datetime:o.a.createElement(H.a,{title:P()(e.snippet.publishedAt).format("YYYY-MM-DD HH:mm:ss")},o.a.createElement("span",null,P()().fromNow()))})})))}}]),a}(o.a.Component),K=(T.a.Option,{labelCol:{span:8},wrapperCol:{span:16}}),V={wrapperCol:{offset:8,span:16}},Q=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={utl:"",keywords:[],subscribed:!1},e.handleSubscribe=function(t){t.preventDefault(),e.setState({confirmLoading:!0,record:null});JSON.parse(localStorage.getItem("admin"));e.props.form.validateFieldsAndScroll((function(t,a){var n=a.url,r=a.keywords,o="".concat(n,"&keywords=").concat(r.join());t?e.setState({confirmLoading:!1}):L({url:o},(function(t){e.setState({visible:!1,confirmLoading:!1,subscribed:!0,url:n,keywords:r}),O.a.success("Subscribed!")}),(function(t){O.a.error("Error while subscribing"),e.props.form.resetFields(),e.setState({visible:!1,confirmLoading:!1})}))}))},e.unsubscribe=function(){U({},(function(){}),(function(){})),e.setState({subscribed:!1,url:"",keywords:""})},e}return Object(p.a)(a,[{key:"componentWillUnmount",value:function(){this.unsubscribe(),window.addEventListener("beforeunload",U)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.url,n=t.keywords,r=t.subscribed;return o.a.createElement(o.a.Fragment,null,!r&&o.a.createElement(B.a,Object.assign({},K,{name:"basic",onSubmit:this.handleSubscribe}),o.a.createElement(B.a.Item,{label:"URL"},e("url",{rules:[{required:!0,message:"Please input livestream URL!"}]})(o.a.createElement(F.a,null))),o.a.createElement(B.a.Item,{label:"Add Keywords"},e("keywords",{rules:[{required:!0,message:"Kewords are required!"}]})(o.a.createElement(T.a,{mode:"tags",placeholder:"add keywords"}))),o.a.createElement(B.a.Item,V,o.a.createElement(f.a,{type:"primary",htmlType:"submit"},"Subscribe"))),r&&o.a.createElement(u.a,null,o.a.createElement("p",null,o.a.createElement("b",null,"URL")," : ",a),o.a.createElement("p",null,"keywords"),n.map((function(e){return o.a.createElement(M.a,null,e)})),o.a.createElement(f.a,{type:"primary",onClick:this.unsubscribe,style:{margin:10}},"Unsubscribe"),o.a.createElement(z,null)))}}]),a}(o.a.Component),G=B.a.create({name:"subscribe"})(Q),X=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={subscribed:!1,url:"",keywords:[]},e}return Object(p.a)(a,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this.state.subscribed;return o.a.createElement(y,this.props,!e&&o.a.createElement(u.a,null,o.a.createElement(G,null)))}}]),a}(o.a.Component),Z=v.a.Footer,$=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"componentWillMount",value:function(){var e;(e=this.props).location.pathname===w.login&&x(e)}},{key:"render",value:function(){return o.a.createElement("main",{className:"auth"},o.a.createElement("div",{className:"logo"},o.a.createElement("img",{src:g.a,alt:"logo"})),o.a.createElement("div",{className:"login"},o.a.createElement(u.a,{bordered:!1},o.a.createElement("div",{className:"title"},"Quillbot"),o.a.createElement("p",{className:"sub-title"},"Please log in using google to continue!"),o.a.createElement("a",{href:"".concat("http://localhost:1337","/auth/google")},o.a.createElement(f.a,{block:!0,type:"primary",size:"large",shape:"round"},"Continue with Google")))),o.a.createElement(Z,null,"Developed by",o.a.createElement(f.a,{type:"link",href:"",block:!0,target:"_blank"},"Shubham")))}}]),a}(o.a.Component),ee=(a(415),a(190)),te=(a(178),a(99)),ae=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(m.a)(this,a),t.call(this,e)}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(te.a,{status:"500",title:"500",subTitle:"Sorry, something went wrong.",extra:o.a.createElement(f.a,{type:"primary",onClick:function(){return e.props.history.push}},"Back Home")})}}]),a}(o.a.Component),ne=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={error:!1,loggingIn:!1},e}return Object(p.a)(n,[{key:"componentWillMount",value:function(){var e=this;console.log("here");var t=a(418),n=t.parse(this.props.location.search,{ignoreQueryPrefix:!0});console.log(n),this.setState({loggingIn:!0}),function(e,t,a,n){N({path:"/auth/google/callback?".concat(e),params:t,cb:a,err:n})}(t.stringify(n),{},(function(t){var a=t.data.data,n=a.jwt,r=a.user;localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(r)),e.props.history.push(w.home),window.history.pushState({},"Home","/"),e.setState({loggingIn:!1}),window.location.reload(!0)}),(function(t){e.setState({error:!0})}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.loggingIn;return o.a.createElement(o.a.Fragment,null,a&&o.a.createElement(ee.a,null),t&&o.a.createElement(ae,null))}}]),n}(o.a.Component),re=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(y,this.props,o.a.createElement(te.a,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:o.a.createElement(f.a,{type:"primary",onClick:function(){return e.props.history.push("/")}},"Back Home")}))}}]),a}(o.a.Component),oe=function(e){var t=e.component,a=Object(n.a)(e,["component"]),r=localStorage.getItem("token");return o.a.createElement(s.b,Object.assign({},a,{render:function(e){return r?o.a.createElement(t,e):o.a.createElement(s.a,{to:w.login})}}))},ce=function(){return o.a.createElement(i.a,null,o.a.createElement(s.d,null,o.a.createElement(s.b,{exact:!0,path:w.auth,component:ne}),o.a.createElement(oe,{exact:!0,path:w.dashboard,component:X}),o.a.createElement(s.b,{exact:!0,path:w.login,component:$}),o.a.createElement(s.b,{path:"*",exact:!0,component:re})))};l.a.render(o.a.createElement(ce,null),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.f522ef2a.chunk.js.map