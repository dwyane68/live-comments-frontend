(this.webpackJsonpdeployer=this.webpackJsonpdeployer||[]).push([[0],{235:function(e,t,a){e.exports=a(498)},240:function(e,t,a){},495:function(e,t){},498:function(e,t,a){"use strict";a.r(t);var r=a(232),n=a(0),o=a.n(n),l=a(5),s=a.n(l),c=a(57),i=a(56),u=(a(240),a(241),a(231)),m=(a(499),a(230)),d=(a(49),a(19)),p=a(27),h=a(28),g=a(30),f=a(31),E=a(50),b=a.n(E),y=(a(252),a(8)),v=(a(163),a(111)),w=(a(255),a(222)),S={dashboard:"/",login:"/login",register:"/register",setupShop:"/setup-shop",onGoing:"/on-going",shopItem:"/shop-items",auth:"/auth/:provider/callback",projectDetail:"/project/:uID",deployProject:"/project/:uID/deploy",cart:"/cart",checkout:"/checkout",orderHistory:"/order-history",viewVendor:"/vendors",viewVolunteer:"/volunteers"},j="http://deployer-backend.craffcodes.com",O={},k={BASE_URL:j,path:S,color:O,DEV_MODE:!0,SOCKET_PORT:1342},I={};try{var D=localStorage.getItem("user");D&&(I=JSON.parse(D))}catch(Se){console.error(Se)}var P=I,N=P.username,C=P.role,L=(P.shop,C&&C.name,function(){return o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"picture"},o.a.createElement(w.a,{style:{color:"#fff",backgroundColor:O.primary},size:"large"},N)),o.a.createElement("div",{className:"designation"},o.a.createElement("div",{className:"name"},N),o.a.createElement("div",{className:"role"},C.name)))}),A=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(p.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).logOut=function(){localStorage.clear(),e.props.hideSidebar(),e.props.history.replace("/login"),window.history.pushState({},"Login","/"),window.location.reload(!0)},e}return Object(h.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"side-header"},o.a.createElement("div",{className:"logo"},o.a.createElement("img",{src:b.a,alt:"Janta Vendor"})),o.a.createElement(L,null)),o.a.createElement("div",{className:"side-body"},o.a.createElement("ul",null,o.a.createElement(i.b,{exact:!0,to:S.dashboard},o.a.createElement("li",{onClick:this.props.hideSidebar},"Dashboard")))),o.a.createElement("div",{className:"side-footer"},o.a.createElement("ul",null,o.a.createElement("li",{onClick:this.logOut},"Log Out"))))}}]),a}(n.Component),V=v.a.Footer,q=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).state={showSidebar:!1},r.hideSidebar=function(){r.setState({showSidebar:!1})},r}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.state.showSidebar;return o.a.createElement("main",{className:t?"show-sidebar":""},o.a.createElement("div",{className:"sidebar-control",onClick:function(){e.setState({showSidebar:!0})}},o.a.createElement("svg",{height:"40",width:"40"},o.a.createElement("polygon",{points:"0,0 0,40 40,0",className:"triangle"})),o.a.createElement(y.a,{type:"arrow-right"})),o.a.createElement(A,Object.assign({},this.props,{hideSidebar:this.hideSidebar})),o.a.createElement("div",{className:"sidebar-overlay",onClick:function(){e.setState({showSidebar:!1})}}),o.a.createElement("div",{className:"main-bar"},this.props.children),o.a.createElement(V,null,"Developed by",o.a.createElement(d.a,{type:"link",href:"https://www.craffcodes.com",block:!0,target:"_blank"},"Craffcodes")))}}]),a}(o.a.Component),U=(a(83),a(24)),_=a(48),F=a.n(_),M=(a(500),k.BASE_URL),J=localStorage.getItem("token");J&&(F.a.defaults.headers.common.Authorization="Bearer ".concat(J));var x=new Promise((function(e,t){localStorage.getItem("access_token")?(F.a.defaults.headers.common.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e(!0)):F.a.get("".concat(M,"/")).then((function(t){var a=t.data;t.data.success&&(localStorage.setItem("access_token",a.data.token),F.a.defaults.headers.common.Authorization="Bearer ".concat(localStorage.getItem("access_token"))),e(!0)}))})),R=function(e){var t=e.path,a=e.params,r=(e.headers,e.cb),n=e.err;x.then((function(){F.a.get("".concat(M).concat(t),{params:a}).then((function(e){200===e.status&&r?r(e):n&&n(e.error)})).catch((function(e){return k.DEV_MODE||e&&e.response&&404===e.response.status?(n&&n(e.response),void U.a.error("Connection Error!")):e&&e.response&&401===e.response.status?(U.a.warning("Unauthorised request! You will be logged out."),void B((function(){setTimeout((function(){window.location.reload(!0)}),300)}))):void U.a.warning("Something went wrong!!")}))}))},z=function(e){var t=e.path,a=e.params,r=(e.headers,e.cb),n=e.err;x.then((function(){F.a.post("".concat(M).concat(t),a).then((function(e){200!==e.status&&201!==e.status||!r?n(e):r(e.data)})).catch((function(e){return k.DEV_MODE||404===e.response.status?n?void n(e.response):void U.a.warning("Something went wrong!!"):e&&e.response&&401===e.response.status?(U.a.warning("Unauthorised request! You will be logged out."),void B((function(){setTimeout((function(){window.location.reload(!0)}),300)}))):void U.a.warning("Something went wrong!!")}))}))},T=function(e){var t=e.path,a=e.params,r=(e.headers,e.cb),n=e.err;x.then((function(){F.a.put("".concat(M).concat(t),a).then((function(e){200===e.status&&r?r(e.data):n(e)})).catch((function(e){console.log(e),n&&n(e.error)}))}))},B=function(e){localStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("permissions"),e({status:200,message:"Logged Out!"})},W=function(e,t,a){R({path:"/projects",params:e,cb:t,err:a})},H=function(e){var t=JSON.parse(localStorage.getItem("user")),a=localStorage.getItem("token");if(!t||!a)return window.history.pushState({},"Login","/"),void e.history.push(S.login);window.history.pushState({},"Dashboard","/"),e.history.push(S.dashboard)},K=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).showDetails=function(e){r.props.history.push("/project/".concat(e.uID))},r.closeViewMode=function(){r.setState({viewDetail:!1,selectedOrder:{}})},r.getProjects=function(){JSON.parse(localStorage.getItem("user"));W({_sort:"id:desc"},(function(e){var t=e.data;r.setState({viewDetail:!1,list:t})}))},r.columns=[{title:"Name",dataIndex:"name",key:"name",render:function(e){return e}},{title:"Last Deployed",dataIndex:"updated_at",key:"updated_at",render:function(e){return"".concat(new Date(e).toDateString(),", ").concat(new Date(e).toLocaleTimeString())}},{title:"Status",dataIndex:"status",key:"status"},{title:"Action",key:"operation",render:function(e,t){return o.a.createElement(d.a,{onClick:function(){r.showDetails(t)}},"View")}}],r.state={list:[],unassignedOrders:[],statuses:[],viewDetail:!1,loading:!0,selectedOrder:{}},r}return Object(h.a)(a,[{key:"componentWillMount",value:function(){H(this.props);JSON.parse(localStorage.getItem("user"));this.getProjects()}},{key:"render",value:function(){var e=this.state,t=e.list,a=(e.unassignedOrders,e.viewDetail);e.selectedOrder,e.statuses;return console.log(t),o.a.createElement(q,this.props,t&&t.length>0&&o.a.createElement("div",{className:"my-dashboard"},o.a.createElement("h1",null,"My Projects"),o.a.createElement(m.a,{rowKey:"id",columns:this.columns,pagination:!1,dataSource:t}),a&&o.a.createElement(u.a,{width:520,visible:a,onClose:this.closeViewMode})))}}]),a}(o.a.Component),Y=(a(221),a(119)),G=(a(148),a(15)),$=(a(149),a(26)),Q=v.a.Footer,X={labelCol:{span:8},wrapperCol:{span:16}},Z={wrapperCol:{offset:8,span:16}},ee=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleLogin=function(e){e.preventDefault(),r.setState({confirmLoading:!0,record:null}),r.props.form.validateFieldsAndScroll((function(e,t){e?r.setState({confirmLoading:!1}):function(e,t,a){z({path:"/auth/local",params:e,cb:t,err:a})}(t,(function(e){e.user;localStorage.setItem("user",JSON.stringify(e.user)),localStorage.setItem("token",e.jwt),U.a.success("Login success! You will be redirected shortly.",1,r.redirect)}),(function(e){U.a.error("Error occurred!"),r.props.form.resetFields(),r.setState({visible:!1,confirmLoading:!1})}))}))},r.redirect=function(){window.location.reload(!0)},r.state={loading:!1},r}return Object(h.a)(a,[{key:"componentWillMount",value:function(){H(this.props)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return o.a.createElement("main",{className:"auth"},o.a.createElement("div",{className:"logo"},o.a.createElement("img",{src:b.a,alt:"logo"})),o.a.createElement("div",{className:"login"},o.a.createElement(Y.a,{bordered:!1},o.a.createElement("div",{className:"title"},"JANTA SAMAN"),o.a.createElement("p",{className:"sub-title"},"Please log in to continue!"),o.a.createElement(G.a,Object.assign({},X,{name:"basic",onSubmit:this.handleLogin}),o.a.createElement(G.a.Item,{label:"Username"},t("identifier",{initialValue:"",rules:[{required:!0,message:"Please input your username!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Password",rules:[{required:!0,message:"Please input your password!"}]},t("password",{initialValue:"",rules:[{required:!0,message:"Please input your password!"}]})(o.a.createElement($.a.Password,null))),o.a.createElement(G.a.Item,Z,o.a.createElement(d.a,{block:!0,type:"primary",size:"large",shape:"round",htmlType:"submit"},"Login"))),o.a.createElement("p",{align:"center"},"OR"),o.a.createElement(d.a,{block:!0,type:"primary",size:"large",shape:"round",onClick:function(){return e.props.history.push("/register")}},"Register"))),o.a.createElement(Q,null,"Developed by",o.a.createElement(d.a,{type:"link",href:"www.craffcodes.com",block:!0,target:"_blank"},"Craffcodes")))}}]),a}(o.a.Component),te=G.a.create({name:"login"})(ee),ae=(a(203),a(58)),re=(a(207),a(118)),ne=(a(204),a(34)),oe=a(79),le={labelCol:{span:8},wrapperCol:{span:16}},se={wrapperCol:{offset:8,span:16}},ce=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).populateDetails=function(e){r.props.form.setFieldsValue({name:e&&e.name,user:e&&e.user,chownUser:e&&e.chownUser,host:e&&e.host,repositoryUrl:e&&e.repositoryUrl,deployPath:e&&e.deployPath,sshKey:e&&e.sshKey,buildCommands:e&&e.buildCommands,branch:e&&e.branch,port:e&&e.port})},r.handleAddProject=function(e){var t=r.state.project;if(e.preventDefault(),r.setState({confirmLoading:!0,record:null}),t)r.updateProject();else{var a=JSON.parse(localStorage.getItem("user"));r.props.form.validateFieldsAndScroll((function(e,t){e?r.setState({confirmLoading:!1}):(t.owner=a.id,function(e,t,a){z({path:"/projects",params:e,cb:t,err:a})}(t,(function(e){r.updateUser(e)}),(function(e){U.a.error("Error adding Project"),r.props.form.resetFields(),r.setState({visible:!1,confirmLoading:!1})})))}))}},r.updateUser=function(e){var t=r.state.project;r.props.form.validateFieldsAndScroll((function(e,a){e?r.setState({confirmLoading:!1}):function(e,t,a,r){T({path:"/projects/".concat(e),params:t,cb:a,err:r})}(t.id,a,(function(e){r.updateUser(e)}),(function(e){U.a.error("Error adding Project"),r.props.form.resetFields(),r.setState({visible:!1,confirmLoading:!1})}))}))},r.projectAdded=function(e){r.props.history.push("/"),window.location.reload()},r.state={locations:[],project:null},r}return Object(h.a)(a,[{key:"componentWillReceiveProps",value:function(e,t){var a=this.state.project,r=e.project;a!==r&&r&&(this.setState({project:r}),this.populateDetails(r))}},{key:"render",value:function(){var e=this.state,t=(e.locations,e.project,this.props.form.getFieldDecorator);return o.a.createElement(G.a,Object.assign({},le,{name:"basic",onSubmit:this.handleAddProject}),o.a.createElement(ne.a,{sm:24,lg:12},o.a.createElement(G.a.Item,{label:"Project Name"},t("name",{initialValue:"",rules:[{required:!0,message:"Please input your project name!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"SSH User"},t("user",{initialValue:"",rules:[{required:!0,message:"User is required!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Password (Leave blank if you do not wish to update)"},t("password",{initialValue:"",rules:[]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Chown User (Add if additional permissions required after deployment)"},t("chownUser",{initialValue:"",rules:[]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Deploy Path"},t("deployPath",{initialValue:"",rules:[{required:!0,message:"Port is required!"}]})(o.a.createElement($.a,null)))),o.a.createElement(ne.a,{sm:12,lg:12},o.a.createElement(G.a.Item,{label:"Host"},t("host",{initialValue:"",rules:[{required:!0,message:"Host is required!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Port"},t("port",{initialValue:"",rules:[{required:!0,message:"Port is required!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Repository Url"},t("repositoryUrl",{initialValue:"",rules:[]})(o.a.createElement(oe.a,{rows:2}))),o.a.createElement(G.a.Item,{label:"Branch"},t("branch",{initialValue:"",rules:[{required:!0,message:"Port is required!"}]})(o.a.createElement($.a,null)))),o.a.createElement(ne.a,{lg:18},o.a.createElement(G.a.Item,{label:"SSH Key"},t("sshKey",{initialValue:"",rules:[]})(o.a.createElement(oe.a,{rows:4}))),o.a.createElement(G.a.Item,{label:"Build commands(Each command on new line)"},t("buildCommands",{initialValue:"",rules:[]})(o.a.createElement(oe.a,{rows:2})))),o.a.createElement(G.a.Item,se,o.a.createElement(d.a,{type:"primary",htmlType:"submit"},"Save")))}}]),a}(o.a.Component),ie=G.a.create({name:"add_project"})(ce),ue=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).projectAdded=function(){},r.deployProject=function(){var e=r.props.match.params.uID;r.props.history.push("/project/".concat(e,"/deploy"))},r.state={createProject:!1,editProject:!1,viewProject:!1,locations:[],project:null},r}return Object(h.a)(a,[{key:"componentWillMount",value:function(){var e=this,t=(JSON.parse(localStorage.getItem("user")),this.props.match.params.uID);W({uID:t},(function(t){e.setState({viewProject:!0,project:t.data[0],createProject:!1})}))}},{key:"render",value:function(){var e=this.state.project;return o.a.createElement(q,this.props,o.a.createElement("div",{className:"my-project"},o.a.createElement("h1",null,e&&e.name),o.a.createElement("div",{className:"vendor-filters"},"Last deployed: ",e&&new Date(e.updated_at).toDateString()," ",o.a.createElement(d.a,{type:"primary",onClick:this.deployProject},"Deploy")),o.a.createElement(re.a,null),o.a.createElement("h1",null,"Details"),o.a.createElement("div",{className:"vendor-filters"},o.a.createElement(ae.a,{gutter:34},o.a.createElement(ie,Object.assign({projectAdded:this.projectAdded,project:e},this.props))))))}}]),a}(o.a.Component),me=(a(469),a(161)),de=a(121),pe=(localStorage.getItem("token"),a(471)),he=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleData=function(e){console.log(e),e&&("deployment_complete"===e.code?(r.audio.play(),U.a.success("Deployment complete!"),r.setState({deploying:!1,deployed:!0,logs:[].concat(Object(de.a)(r.state.logs),[e.message])},(function(e){console.log(e),r.setState({deploying:!1,deployed:!0})}))):"error"===e.code?r.setState({logs:[].concat(Object(de.a)(r.state.logs),[e.message]),showStatus:!0,deploying:!1,deployed:!0}):r.setState({logs:[].concat(Object(de.a)(r.state.logs),[e.message]),showStatus:!0,deploying:!0}))},r.deployProject=function(){var e=r.props.match.params.uID;r.setState({deploying:!0,showStatus:!0,logs:[]}),z({path:"/deploy",params:{projectID:e},cb:function(e){},err:function(e){r.setState({deploying:!1,deployed:!0})}})},r.state={showStatus:!1,deploying:!1,project:null,deployed:!1,logs:[]},r.socket=pe("".concat(j,":").concat(1342),{transports:["websocket"],reconnection:!0,upgrade:!1}),r.audio=new Audio("".concat("http://deployer.craffcodes.com","/media/just-saying.mp3")),r}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.uID;this.state.logs.length>0&&this.setState({deploying:!0}),this.socket.on("connect",(function(){console.log("Connected!")})),this.socket.emit("join",{uID:e}),this.socket.on("message",this.handleData)}},{key:"componentWillMount",value:function(){var e=this,t=(JSON.parse(localStorage.getItem("user")),this.props.match.params.uID);W({uID:t},(function(t){e.setState({viewProject:!0,project:t.data[0],createProject:!1})}))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.project,a=(e.deploying,e.logs),r=e.showStatus,n=e.deployed;return o.a.createElement(q,this.props,o.a.createElement("div",{className:"my-project"},o.a.createElement("h1",null,t&&t.name),o.a.createElement("div",{className:"vendor-filters"},"Last deployed: ",t&&new Date(t.updated_at).toDateString()," ",!n&&o.a.createElement(d.a,{type:"primary",onClick:this.deployProject,loading:this.state.deploying},"Deploy now  ")," ",n&&o.a.createElement(d.a,{type:"primary",onClick:function(){return window.location.reload()}},"Deploy again  ")),o.a.createElement(re.a,null),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement("h1",null,"Deployment Status"),o.a.createElement(me.a,null,a&&a.map((function(e,t){return o.a.createElement(me.a.Item,{key:t},e)}))))))}}]),a}(o.a.Component),ge={labelCol:{span:8},wrapperCol:{span:16}},fe={wrapperCol:{offset:8,span:16}},Ee=[{required:!0,message:"Please input Mobile Number!"},{pattern:/^([789])[0-9]{9}$/,message:"Please enter valid 10 digit Indian Phone Number!"}],be=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e)).handleLogin=function(e){e.preventDefault(),r.setState({confirmLoading:!0,record:null}),r.props.form.validateFieldsAndScroll((function(e,t){e?r.setState({confirmLoading:!1}):(t.confirmed=!1,t.username=t.email.match(/^([^@]*)@/)[1],function(e,t,a){z({path:"/auth/local/register",params:e,cb:t,err:a})}(t,(function(e){U.a.success("Register success! You will be notified by email or phone once confirmed.",10,r.redirect)}),(function(e){if(e.data.message)for(var t in console.log(e.data.message),e.data.message){var a=e.data.message[t];for(var n in a){var o=a[n];for(var l in o)U.a.error(o[l].message)}}else U.a.error("Error occurred!");r.setState({visible:!1,confirmLoading:!1})})))}))},r.redirect=function(){window.location.reload(!0)},r.state={loading:!1},r}return Object(h.a)(a,[{key:"componentWillMount",value:function(){H(this.props)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return o.a.createElement("main",{className:"auth"},o.a.createElement("div",{className:"logo"},o.a.createElement("img",{src:b.a,alt:"logo"})),o.a.createElement("div",{className:"login"},o.a.createElement(Y.a,{bordered:!1},o.a.createElement("div",{className:"title"},"JANTA SAMAN"),o.a.createElement("p",{className:"sub-title"},"Register Here!"),o.a.createElement(G.a,Object.assign({},ge,{name:"basic",onSubmit:this.handleLogin}),o.a.createElement(G.a.Item,{label:"First Name"},t("firstName",{initialValue:"",rules:[{required:!0,message:"Please input your first name!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Last Name"},t("lastName",{initialValue:"",rules:[{required:!0,message:"Please input your first name!"}]})(o.a.createElement($.a,null))),o.a.createElement(G.a.Item,{label:"Email",colon:!1},t("email",{rules:[{required:!0,message:"Please input Email ID!"}]})(o.a.createElement($.a,{size:"large",type:"email"}))),o.a.createElement(G.a.Item,{label:"Phone",colon:!1},t("phone",{rules:Ee})(o.a.createElement($.a,{size:"large",type:"text"}))),o.a.createElement(G.a.Item,{label:"Password",rules:[{required:!0,message:"Please input your password!"}]},t("password",{initialValue:"",rules:[{required:!0,message:"Please input your password!"}]})(o.a.createElement($.a.Password,null))),o.a.createElement(G.a.Item,fe,o.a.createElement(d.a,{block:!0,type:"primary",size:"large",shape:"round",htmlType:"submit"},"Register"))),o.a.createElement("p",{align:"center"},"OR"),o.a.createElement(d.a,{block:!0,type:"primary",size:"large",shape:"round",onClick:function(){return e.props.history.push("/login")}},"Login"))))}}]),a}(o.a.Component),ye=G.a.create({name:"register"})(be),ve=function(e){var t=e.component,a=Object(r.a)(e,["component"]),n=localStorage.getItem("token");return o.a.createElement(c.b,Object.assign({},a,{render:function(e){return n?o.a.createElement(t,e):o.a.createElement(c.a,{to:S.login})}}))},we=function(){return o.a.createElement(i.a,null,o.a.createElement(c.d,null,o.a.createElement(ve,{exact:!0,path:S.dashboard,component:K}),o.a.createElement(c.b,{exact:!0,path:S.login,component:te}),o.a.createElement(c.b,{exact:!0,path:S.register,component:ye}),o.a.createElement(c.b,{exact:!0,path:S.projectDetail,component:ue}),o.a.createElement(c.b,{exact:!0,path:S.deployProject,component:he})))};s.a.render(o.a.createElement(we,null),document.getElementById("root"))},50:function(e,t,a){e.exports=a.p+"static/media/logo.4e2b85f3.png"}},[[235,1,2]]]);
//# sourceMappingURL=main.7aa79a16.chunk.js.map